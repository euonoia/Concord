import{H as i}from"./html5-qrcode-scanner-CK0YHsee.js";function u(){const n=document.getElementById("start-btn"),r=document.getElementById("scan-line"),t=document.getElementById("feedback");if(!n)return;let o=null,d=null;n.addEventListener("click",async()=>{n.disabled=!0,n.style.display="none",r?.classList.remove("hidden"),o=new i("reader");try{const e=await i.getCameras();if(!e||e.length===0)throw new Error("No camera devices found.");const a=e.find(s=>s.label.toLowerCase().includes("back")||s.label.toLowerCase().includes("rear"));d=a?a.id:e[0].id,await o.start(d,{fps:15,qrbox:{width:250,height:250},aspectRatio:1},async s=>{await o.stop(),r?.classList.add("hidden"),l(s)})}catch(e){console.error(e),alert(`Camera failed to start.

• Make sure you are using HTTPS
• Allow camera permissions
• Close other apps using the camera`),c()}});async function l(e){t?.classList.remove("hidden"),t.className="p-4 rounded-2xl mb-6 text-sm font-bold bg-blue-50 text-blue-700 animate-pulse",t.innerText="Verifying Station Security...";try{const a=await fetch(e,{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json"}});if(!a.ok){const s=await a.json();throw new Error(s.message||"Invalid QR Code")}t.className="p-4 rounded-2xl mb-6 text-sm font-bold bg-emerald-50 text-emerald-700",t.innerText="Success! Attendance Recorded.",navigator.vibrate&&navigator.vibrate(200),setTimeout(()=>{window.location.href="/hr/dashboard"},2e3)}catch(a){t.className="p-4 rounded-2xl mb-6 text-sm font-bold bg-red-50 text-red-700",t.innerText=a.message,c()}}function c(){n.disabled=!1,n.style.display="block",r?.classList.add("hidden")}}export{u as default};
